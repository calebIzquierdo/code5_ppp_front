<div class="carta-presentacion-container">
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <div class="icon-circle">
          <ion-icon name="document-text-outline"></ion-icon>
        </div>
        <div class="title-info">
          <h1 class="page-title">Carta de Presentación</h1>
          <p class="page-subtitle">Mis Prácticas/Carta de Presentación</p>
        </div>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn-solicitar" (click)="abrirModal()">
        <ion-icon name="add"></ion-icon>
        Solicitar Carta
      </button>
      <button class="btn-refresh" (click)="cargarDatosIniciales()" [disabled]="loading">
        <ion-icon name="refresh-sharp"></ion-icon>
        {{ loading ? 'Actualizando...' : 'Actualizar' }}
      </button>
    </div>
  </div>

  <div class="panel-contenido">
    <!-- Filtros (defaultSemestre comentado temporalmente) -->
    <app-carta-filters [filtrosDisponibles]="filtrosDisponibles" [defaultCampus]="filtroCampus"
      [defaultEscuela]="filtroEscuela" (filtrosChange)="onFiltrosChange($event)">
    </app-carta-filters>

    <div class="tabs-container">
      <button class="tab-btn active">
        <ion-icon name="document-outline"></ion-icon>
        Cartas
      </button>
    </div>

    <div class="my-div"></div>

    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <app-carta-list [cartas]="cartasPaginadas" [loading]="loading" [estadosDisponibles]="filtrosDisponibles.estados"
      [paginaActual]="paginaActual" [itemsPorPagina]="itemsPorPagina" [totalPaginas]="totalPaginas"
      [cartasFiltradas]="cartasFiltradas" (estadoChange)="onEstadoChange($event)" (buscar)="onBuscar($event)"
      (ordenar)="onOrdenar()" (cambiarPagina)="onCambiarPagina($event)"
      (cambiarItemsPorPagina)="onCambiarItemsPorPagina($event)" (verDetalle)="onVerDetalle($event)"
      (nuevaSolicitud)="abrirModal()">
    </app-carta-list>
  </div>

  <app-carta-form-modal *ngIf="mostrarModal" [idAlumno]="idAlumno" [alumnoInfo]="alumnoInfo" [empresas]="empresas"
    [cargandoEmpresas]="cargandoEmpresas" (cerrar)="cerrarModal()" (cartaCreada)="onCartaCreada()">
  </app-carta-form-modal>

  <div *ngIf="toastExito" class="toast-overlay">
    <div class="toast-exito">
      <div class="toast-icon">
        <ion-icon name="checkmark-circle-outline"></ion-icon>
      </div>
      <div class="toast-text">
        <h3>Enviado</h3>
        <p>Tu solicitud se ha enviado exitosamente, recibirás una notificación cuando esté disponible.</p>
      </div>
    </div>
  </div>
</div>